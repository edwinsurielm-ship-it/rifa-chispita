<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Gran Rifa Chispitas</title>

<style>
body {
  font-family: Arial;
  text-align: center;
  background: #f5f5f5;
}

h1 { color: #e67e22; }

.contador {
  font-size: 20px;
  margin: 15px;
  font-weight: bold;
}

.grid {
  display: grid;
  grid-template-columns: repeat(10, 1fr);
  gap: 8px;
  max-width: 600px;
  margin: auto;
}

.numero {
  padding: 10px;
  background: white;
  border: 1px solid black;
  border-radius: 5px;
}

.vendido {
  background: gray;
  color: white;
  text-decoration: line-through;
}

.ganador {
  background: green;
  color: white;
  font-weight: bold;
}

button {
  margin-top: 20px;
  padding: 10px 20px;
  font-size: 18px;
}
</style>
</head>

<body>

<h1>üéâ Gran Rifa üéâ</h1>

<p><b>Fecha:</b> 10 de marzo</p>

<p>
Debe tener 70% de boletos vendidos, de lo contrario se aplazar√° m√°s la fecha.
</p>

<h2>üèÜ PREMIOS</h2>
<p>
Cachorra Pomerania de 2 meses y medio<br>
<b>(Chispitas)</b>
</p>

<div class="contador" id="contador"></div>

<h2>üéüÔ∏è N√∫meros disponibles</h2>
<div class="grid" id="numeros"></div>

<div id="adminPanel" style="display:none;">
  <button onclick="girar()">üé∞ Girar T√≥mbola</button>
</div>

<h2 id="ganador"></h2>

<script>

// Detectar si es laptop (admin) o celular (cliente)
const esAdmin = !/Mobi|Android|iPhone/i.test(navigator.userAgent);

if(esAdmin){
  document.getElementById("adminPanel").style.display="block";
}

// Datos guardados
let vendidos = JSON.parse(localStorage.getItem("vendidos")) || [];
let ganador = localStorage.getItem("ganador");

// CONTADOR FECHA
function actualizarContador() {
  let fecha = new Date("2026-03-10");
  let hoy = new Date();

  let diferencia = fecha - hoy;

  if (diferencia <= 0) {
    document.getElementById("contador").innerText =
      "‚è≥ Fecha alcanzada.";
    return;
  }

  let dias = Math.floor(diferencia / (1000 * 60 * 60 * 24));
  document.getElementById("contador").innerText =
    "‚è≥ Faltan " + dias + " d√≠as para el sorteo.";
}

actualizarContador();

// Crear n√∫meros
const contenedor = document.getElementById("numeros");

for (let i = 1; i <= 100; i++) {

  let div = document.createElement("div");
  div.className = "numero";
  div.innerText = i;

  if (vendidos.includes(i)) div.classList.add("vendido");
  if (ganador == i) div.classList.add("ganador");

  // Solo admin puede marcar vendidos
  if (esAdmin) {
    div.onclick = () => {
      if (vendidos.includes(i)) {
        vendidos = vendidos.filter(n => n != i);
      } else {
        vendidos.push(i);
      }
      localStorage.setItem("vendidos", JSON.stringify(vendidos));
      location.reload();
    };
  }

  contenedor.appendChild(div);
}

// Mostrar ganador
if (ganador) {
  document.getElementById("ganador").innerText =
    "üéâ GANADOR OFICIAL: N√∫mero " + ganador;
}

// Girar t√≥mbola (solo admin)
function girar() {

  const disponibles = [];

  for (let i = 1; i <= 100; i++) {
    if (!vendidos.includes(i)) disponibles.push(i);
  }

  if (disponibles.length === 0) {
    alert("Todos los boletos est√°n vendidos");
    return;
  }

  const g = disponibles[Math.floor(Math.random() * disponibles.length)];

  localStorage.setItem("ganador", g);

  location.reload();
}
</script>

</body>
</html>
